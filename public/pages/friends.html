<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Danh s√°ch b·∫°n b√®</title>
  <link rel="stylesheet" href="/style.css">

</head>
<body>
  <div class="navbar">
    <div class="logo">SocialApp</div>
    <div class="nav-links">
      <a href="/home">Trang ch·ªß</a>
      <a href="/post">Th√™m b·∫°n b√®</a>
      <a href="/Users">B·∫°n b√®</a>
      <a href="/socket">Th√¥ng tin</a>
    </div>
  </div>

  <h1>üìã Danh s√°ch b·∫°n b√®</h1>

  <div class="container-friends-list">
    <table id="friendsTable">
      <thead>
        <tr>
          <th>ID</th>
          <th>Username</th>
          <th>Email</th>
          <th>Gender</th>
          <th>Chi ti·∫øt</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    
    <div id="pagination"></div>
  </div>

  <script>
    let currentPage = 1;

    function loadUsers(page = currentPage) {
      fetch(`/Users/displayUser?page=${page}`)
        .then(res => res.json())
        .then(({ data, totalPages }) => {
          const tbody = document.querySelector('#friendsTable tbody');
          tbody.innerHTML = '';

          data.forEach(user => {
            const row = document.createElement('tr');
            row.innerHTML = `
              <td>${user._id}</td>
              <td>${user.username}</td>
              <td>${user.email}</td>
              <td>${user.gender === 0 ? "Nam" : "N·ªØ"}</td>
              <td><button onclick="viewUser('${user._id}')">Chi ti·∫øt</button></td>
            `;
            tbody.appendChild(row);
          });

          renderPagination(totalPages);
        })
        .catch(err => console.error('‚ùå L·ªói khi t·∫£i d·ªØ li·ªáu:', err));
    }

    function renderPagination(totalPages) {
      const container = document.getElementById('pagination');
      container.innerHTML = '';
      for (let i = 1; i <= totalPages; i++) {
        const btn = document.createElement('button');
        btn.textContent = i;
        btn.onclick = () => {
          currentPage = i;
          loadUsers();
        };
        container.appendChild(btn);
      }
    }

    function viewUser(id) {
      fetch(`/Users/displayUser/${id}`)
        .then(res => res.json())
        .then(user => {
          alert(`üë§ ${user.name.first} ${user.name.last}\nüìß ${user.email}\nüìû ${user.profile.phone}`);
        })
        .catch(err => alert('Kh√¥ng th·ªÉ t·∫£i chi ti·∫øt ng∆∞·ªùi d√πng.'));
    }

    loadUsers();
  </script>
  
</body>
</html>
